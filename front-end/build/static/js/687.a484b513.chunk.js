"use strict";(self.webpackChunkfront_end=self.webpackChunkfront_end||[]).push([[687],{687:(e,a,s)=>{s.r(a),s.d(a,{default:()=>c});var l=s(43),n=s(314),i=s(466),t=s(213),r=s(579);const c=()=>{const[e,a]=(0,l.useState)([]),[s,c]=(0,l.useState)({requestBooks:!1,issueBooks:!1,passwordUpdateOtp:!1,signupOtp:!1,signinOtp:!1}),[o,d]=(0,l.useState)(""),[m,h]=(0,l.useState)(""),[u,x]=(0,l.useState)({}),[g,b]=(0,l.useState)(!1),j=async()=>{b(!0);try{const e=(await t.A.get("/api/admin/mails/config")).data[0];if(!e)return void h("No config found.");const s={};Object.keys(e.toggles).forEach((a=>{s[a]=e.toggles[a].switches})),c(s);const l=e.mails.map((e=>({...e,loading:!1})));a(l);const n={};Object.keys(e.toggles).forEach((a=>{const s=e.toggles[a].mail;n[a]=s||(l.length?l[0].email:"")})),x(n)}catch(e){h("Failed to fetch mail configurations.")}finally{b(!1)}},v=e=>{const{name:a,checked:s}=e.target;c((e=>({...e,[a]:s}))),s||x((e=>({...e,[a]:""})))},p=(e,s)=>{const{name:l,value:n}=s.target;a((a=>{const s=[...a];return s[e][l]=n,s}))},N=e=>{const{name:a,value:s}=e.target;x((e=>({...e,[a]:s})))};return(0,l.useEffect)((()=>{j()}),[]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.A,{}),(0,r.jsx)("header",{id:"main-header",className:"py-2 bg-primary text-white",children:(0,r.jsx)("div",{className:"container",children:(0,r.jsx)("div",{className:"row",children:(0,r.jsx)("div",{className:"col-md-6",children:(0,r.jsxs)("h1",{children:[(0,r.jsx)("i",{className:"fa fa-envelope"})," Mail Configuration"]})})})})}),(0,r.jsxs)("div",{className:"container mt-4",children:[(0,r.jsx)(i.A,{success:o,error:m,dismissAlert:e=>{"error"===e?h(""):"success"===e&&d("")}}),(0,r.jsxs)("div",{className:"card mb-4",children:[(0,r.jsx)("div",{className:"card-header bg-primary text-white",children:(0,r.jsx)("h4",{className:"mb-0",children:"Authenticate Mails (G-mail)"})}),(0,r.jsxs)("div",{className:"card-body",children:[e.map(((s,l)=>(0,r.jsxs)("div",{className:"row mb-3",children:[(0,r.jsx)("div",{className:"col-md-5",children:(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{htmlFor:"email-".concat(l),children:"Email"}),(0,r.jsx)("input",{type:"email",className:"form-control",id:"email-".concat(l),name:"email",value:s.email,onChange:e=>p(l,e),disabled:s.configured||s.loading})]})}),(0,r.jsx)("div",{className:"col-md-5",children:(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{htmlFor:"authKey-".concat(l),children:"Auth Key"}),(0,r.jsx)("input",{type:"text",className:"form-control",id:"authKey-".concat(l),name:"authKey",value:s.authKey,onChange:e=>p(l,e),disabled:s.configured||s.loading})]})}),(0,r.jsx)("div",{className:"col-md-2 d-flex align-items-center",children:s.configured?(0,r.jsx)("button",{className:"btn btn-danger btn-block",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete the mail configuration for ".concat(e,"?")))try{const a=await t.A.post("/api/admin/mails/delete",{email:e});a.data.success?d(a.data.success):h(a.data.error),j()}catch(l){var a,s;h((null===(a=l.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.error)||"Failed to delete mail.")}})(s.email),children:"Delete"}):(0,r.jsx)("button",{className:"btn ".concat(s.loading?"btn-warning":"btn-success"," btn-block"),onClick:()=>(async s=>{a((e=>{const a=[...e];return a[s].loading=!0,a}));try{const a=await t.A.post("/api/admin/mails/configure",{email:e[s].email,authKey:e[s].authKey});a.data.success?d(a.data.success):h(a.data.error),j()}catch(i){var l,n;h((null===(l=i.response)||void 0===l||null===(n=l.data)||void 0===n?void 0:n.error)||"Failed to configure email.")}finally{a((e=>{const a=[...e];return a[s].loading=!1,a}))}})(l),disabled:s.loading,children:s.loading?(0,r.jsx)("div",{className:"spinner-border spinner-border-sm text-light",role:"status",children:(0,r.jsx)("span",{className:"sr-only",children:"Loading..."})}):"Configure"})})]},l))),(0,r.jsx)("div",{className:"row",children:(0,r.jsx)("div",{className:"col-md-6",children:(0,r.jsx)("button",{className:"btn btn-secondary btn-block",onClick:()=>{e.every((e=>e.configured))?a((e=>[...e,{email:"",authKey:"",configured:!1,loading:!1}])):h("Please configure all existing mails before adding new ones.")},children:"Add Mail"})})})]})]}),(0,r.jsxs)("div",{className:"card",children:[(0,r.jsx)("div",{className:"card-header bg-info text-white",children:(0,r.jsx)("h4",{className:"mb-0",children:"Notification Settings"})}),(0,r.jsxs)("div",{className:"card-body",children:[Object.keys(s).map((a=>(0,r.jsxs)("div",{className:"form-group row mb-3",children:[(0,r.jsx)("label",{className:"col-md-4 col-form-label text-capitalize",children:a.replace(/([A-Z])/g," $1")}),(0,r.jsx)("div",{className:"col-md-4",children:(0,r.jsxs)("select",{className:"form-control",name:a,value:u[a]||"",onChange:N,disabled:!s[a],children:[(0,r.jsx)("option",{value:"",disabled:!0,children:"Select Mail"}),e.map(((e,a)=>(0,r.jsx)("option",{value:e.email,disabled:!e.configured,children:e.email},a)))]})}),(0,r.jsx)("div",{className:"col-md-4",children:(0,r.jsxs)("div",{className:"form-check",children:[(0,r.jsx)("input",{className:"form-check-input",type:"checkbox",id:a,name:a,checked:s[a],onChange:v}),(0,r.jsx)("label",{className:"form-check-label",htmlFor:a,children:"Enable"})]})})]},a))),(0,r.jsx)("button",{className:"btn btn-primary btn-lg d-block mx-auto",onClick:async()=>{b(!0);try{const a=await t.A.post("/api/admin/mails/update",{toggles:s,mails:e,selections:u});a.data.success?d(a.data.success):h(a.data.error),j()}catch(n){var a,l;h((null===(a=n.response)||void 0===a||null===(l=a.data)||void 0===l?void 0:l.error)||"Failed to update mail configurations.")}finally{b(!1)}},disabled:g,children:g?(0,r.jsx)("div",{className:"spinner-border spinner-border-sm text-light",role:"status",children:(0,r.jsx)("span",{className:"sr-only",children:"Loading..."})}):"Update"})]})]})]})]})}},314:(e,a,s)=>{s.d(a,{A:()=>c});var l=s(43),n=s(213),i=s(216),t=s(475),r=s(579);const c=()=>{const[e,a]=(0,l.useState)([]),[s,c]=(0,l.useState)(),o=async()=>{try{const e=await n.A.get("/api/global"),s=await e.data;a(s.global),c(s.currentUser)}catch(e){console.error("Error fetching data",e)}};(0,l.useEffect)((()=>{o();const e=setInterval((()=>{o()}),6e4);return()=>clearInterval(e)}),[]);const d=(0,i.Zp)();return(0,r.jsx)("nav",{className:"navbar navbar-expand-lg navbar-dark bg-dark p-0 sticky-top",children:(0,r.jsxs)("div",{className:"container",children:[(0,r.jsx)("a",{className:"navbar-brand",href:"/admin",children:"Home"}),(0,r.jsx)("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation",children:(0,r.jsx)("span",{className:"navbar-toggler-icon"})}),(0,r.jsxs)("div",{className:"collapse navbar-collapse",id:"navbarSupportedContent",children:[(0,r.jsxs)("ul",{className:"navbar-nav",children:[(0,r.jsx)("li",{className:"nav-item px-2",children:(0,r.jsx)(t.N_,{to:"/admin/books/bookInventory/",id:"book_inventory",title:"Book Inventory",className:"nav-link",children:"Book Inventory"})}),(0,r.jsx)("li",{className:"nav-item px-2",children:(0,r.jsx)(t.N_,{to:"/admin/1/users/",id:"users_list",title:"Users",className:"nav-link",children:"Users"})}),(0,r.jsx)("li",{className:"nav-item px-2",children:(0,r.jsx)(t.N_,{to:"/admin/1/addbook",id:"add_book",title:"Add Books",className:"nav-link",children:"Add Books"})}),(0,r.jsx)("li",{className:"nav-item px-2",children:(0,r.jsxs)(t.N_,{to:"/admin/1/book/stockout",id:"stock_out",title:"Stock Out",className:"nav-link",children:["StockOut\xa0",(0,r.jsx)("span",{className:"badge badge-danger",children:e.stock?e.stock:0})]})}),(0,r.jsx)("li",{className:"nav-item px-2",children:(0,r.jsxs)(t.N_,{to:"/admin/1/book/request",id:"request",title:"request",className:"nav-link",children:["Request\xa0",(0,r.jsx)("span",{className:"badge badge-success",children:e.reqbook?e.reqbook:0})]})}),(0,r.jsx)("li",{className:"nav-item px-2",children:(0,r.jsxs)(t.N_,{to:"/admin/1/book/return",id:"return",title:"return",className:"nav-link",children:["Return\xa0",(0,r.jsx)("span",{className:"badge badge-warning",children:e.return?e.return:0})]})}),(0,r.jsx)("li",{className:"nav-item px-2",children:(0,r.jsx)(t.N_,{to:"/books",title:"Browse Books",className:"nav-link",children:"Browse Books"})})]}),(0,r.jsx)("ul",{className:"navbar-nav ml-auto",children:s?(0,r.jsxs)("li",{className:"nav-item dropdown mr-3",children:[(0,r.jsxs)("a",{href:"#",className:"nav-link dropdown-toggle","data-toggle":"dropdown",id:"admin-drop-down",children:[(0,r.jsx)("i",{className:"fa fa-user"})," Welcome ",s.username]}),(0,r.jsxs)("div",{className:"dropdown-menu",children:[(0,r.jsxs)(t.N_,{to:"/admin/1/profile",title:"profile",className:"dropdown-item",children:[(0,r.jsx)("i",{className:"fa fa-user-circle"})," Profile"]}),(0,r.jsxs)("a",{href:"",onClick:e=>(async e=>{try{e.preventDefault(),await n.A.get("/auth/1/user-logout"),d("/")}catch(a){d("/")}})(e),className:"dropdown-item",children:[(0,r.jsx)("i",{className:"fa fa-user-times"})," Logout"]}),(0,r.jsxs)(t.N_,{className:"dropdown-item",to:"/user/dashboard/1",children:[(0,r.jsx)("i",{className:"fa fa-gear"})," User Dashboard"]})]})]}):(0,r.jsx)("li",{className:"nav-item",children:(0,r.jsxs)("a",{href:"/login",className:"nav-link",children:[(0,r.jsx)("i",{className:"fa fa-gear"})," ProfileLogin"]})})})]})]})})}},466:(e,a,s)=>{s.d(a,{A:()=>n});s(43);var l=s(579);const n=e=>{let{error:a,success:s,warning:n,dismissAlert:i}=e;return(0,l.jsxs)("div",{className:"container my-2 sticky-top",children:[a&&a.length>0&&(0,l.jsxs)("div",{className:"alert alert-danger alert-dismissible fade show",role:"alert",children:[a,(0,l.jsx)("button",{type:"button",className:"close","data-dismiss":"alert","aria-label":"Close",onClick:()=>i("error"),children:(0,l.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),s&&s.length>0&&(0,l.jsxs)("div",{className:"alert alert-success alert-dismissible fade show",role:"alert",children:[s,(0,l.jsx)("button",{type:"button",className:"close","data-dismiss":"alert","aria-label":"Close",onClick:()=>i("success"),children:(0,l.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),n&&n.length>0&&(0,l.jsxs)("div",{className:"alert alert-warning alert-dismissible fade show",role:"alert",children:[n,(0,l.jsx)("button",{type:"button",className:"close","data-dismiss":"alert","aria-label":"Close",onClick:()=>i("warning"),children:(0,l.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]})]})}}}]);
//# sourceMappingURL=687.a484b513.chunk.js.map