"use strict";(self.webpackChunkfront_end=self.webpackChunkfront_end||[]).push([[105],{105:(e,a,s)=>{s.r(a),s.d(a,{default:()=>g});var t=s(43),r=s(213),l=s(475),n=s(466),c=s(843),o=s(579);const i=e=>{let{handleSubmit:a}=e;const[s,r]=(0,t.useState)(""),[l,n]=(0,t.useState)(""),[c,i]=(0,t.useState)("");return(0,o.jsx)("section",{id:"search_bar",className:"my-3 py-4",style:{background:"rgb(52, 185, 174)"},children:(0,o.jsx)("div",{className:"container",children:(0,o.jsx)("form",{onSubmit:e=>{e.preventDefault();a(e,s,"category"===s?l:c)},children:(0,o.jsxs)("div",{className:"row",children:[(0,o.jsx)("div",{className:"col-md-5 p-1",children:(0,o.jsxs)("select",{name:"filter",id:"filter",className:"form-control",value:s,onChange:e=>{r(e.target.value),n(""),i("")},children:[(0,o.jsx)("option",{value:"",disabled:!0,children:"Select Filter..."}),(0,o.jsx)("option",{value:"title",children:"Title"}),(0,o.jsx)("option",{value:"author",children:"Author"}),(0,o.jsx)("option",{value:"category",children:"Category"}),(0,o.jsx)("option",{value:"ISBN",children:"ISBN"})]})}),"category"===s&&(0,o.jsx)("div",{className:"col-md-5 p-1",children:(0,o.jsxs)("select",{name:"category",id:"category",className:"form-control",value:l,onChange:e=>n(e.target.value),children:[(0,o.jsx)("option",{value:"",disabled:!0,children:"Select Category..."}),["Science","Biology","Physics","Chemistry","Novel","Travel","Cooking","Philosophy","Mathematics","Ethics","Technology"].map((e=>(0,o.jsx)("option",{value:e,children:e},e)))]})}),"category"!==s&&(0,o.jsx)("div",{className:"col-md-5 p-1",children:(0,o.jsx)("input",{name:"searchName",id:"searchName",type:"text",className:"form-control",placeholder:"Search Books",value:c,onChange:e=>i(e.target.value)})}),(0,o.jsx)("div",{className:"col-md-2 p-1",children:(0,o.jsx)("input",{type:"submit",id:"search-book-btn",className:"btn btn-warning btn-block",value:"Search"})})]})})})})};let d;const u=e=>{let{currentUser:a,logout:s}=e;return(0,o.jsx)("nav",{className:"navbar navbar-expand-lg navbar-dark bg-dark p-0 sticky-top",children:(0,o.jsxs)("div",{className:"container",children:[(0,o.jsx)(l.N_,{className:"navbar-brand",to:a?a.isAdmin?"/admin":"/user/dashboard/1":"/",children:"Home"}),(0,o.jsx)("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation",children:(0,o.jsx)("span",{className:"navbar-toggler-icon"})}),(0,o.jsxs)("div",{className:"collapse navbar-collapse",id:"navbarSupportedContent",children:[(0,o.jsx)("ul",{className:"navbar-nav",children:(0,o.jsx)("li",{className:"nav-item active px-2",children:(0,o.jsx)(l.N_,{className:"nav-link",to:"/books",children:"Browse Books"})})}),a?(0,o.jsxs)("ul",{className:"navbar-nav ml-auto",children:[a.violationFlag&&(0,o.jsx)("li",{className:"nav-item align-self-center mr-2",children:(0,o.jsx)("i",{className:"fa fa-flag text-danger"})}),(0,o.jsxs)("li",{className:"nav-item dropdown mr-3",children:[(0,o.jsxs)("a",{href:"#",className:"nav-link dropdown-toggle","data-toggle":"dropdown",children:[(0,o.jsx)("i",{className:"fa fa-user"})," Welcome ",a.username]}),(0,o.jsxs)("div",{className:"dropdown-menu",children:[(0,o.jsxs)(l.N_,{to:a.isAdmin?"/admin/profile":"/user/1/profile",className:"dropdown-item",children:[(0,o.jsx)("i",{className:"fa fa-user-circle"})," Profile"]}),(0,o.jsxs)(l.N_,{to:"",onClick:s,className:"dropdown-item",children:[(0,o.jsx)("i",{className:"fa fa-user-times"})," Logout"]})]})]}),(0,o.jsx)("li",{className:"nav-item",children:(0,o.jsxs)(l.N_,{to:"/user/1/notification",className:"nav-link",children:[(0,o.jsx)("i",{className:"fa fa-bell"}),(0,o.jsx)("span",{className:"badge badge-danger badge-pill",children:"2"})]})})]}):(0,o.jsx)(l.N_,{to:"/signUp",className:"btn btn-primary btn-sm ml-auto",children:"Sign up"})]})]})})},m=e=>{var a,s;let{book:t,currentUser:r,handleRequest:n,current:c}=e;return(0,o.jsx)("div",{className:"card col-md-3 text-center",style:{marginBottom:"10px"},children:(0,o.jsxs)("div",{className:"card-body",children:[(0,o.jsx)("h5",{className:"card-title",children:t.title}),(0,o.jsx)("p",{children:(0,o.jsxs)("small",{style:{color:"red"},children:["Author: ",t.author]})}),(0,o.jsx)("p",{children:(0,o.jsxs)("small",{style:{color:"rgb(20, 168, 40)"},children:["Category: ",t.category]})}),(0,o.jsx)("p",{children:(0,o.jsxs)("small",{style:{color:"rgb(52, 33, 219)"},children:["In stock: ",t.stock]})}),r&&t.stock>=0&&(0,o.jsx)(o.Fragment,{children:null!==(a=r.bookIssueInfo)&&void 0!==a&&a.some((e=>e._id===t._id))?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("a",{href:"#",className:"btn btn-xs btn-warning disabled",role:"button","aria-disabled":"true",children:"Issued!"}),(0,o.jsx)(l.N_,{to:"/books/return-renew",className:"btn btn-xs btn-success",role:"button",children:"Return/Renew"})]}):null!==(s=r.bookRequestInfo)&&void 0!==s&&s.some((e=>e._id===t._id))?(0,o.jsx)("a",{href:"#",className:"btn btn-xs btn-warning disabled",role:"button","aria-disabled":"true",children:"Requested!"}):(0,o.jsx)("form",{action:"/api/books/".concat(t._id,"/request/").concat(r._id,"/").concat(c),method:"POST",className:"d-inline",onSubmit:n,children:(0,o.jsx)("input",{className:"btn btn-sm btn-warning",type:"submit",value:"request"})})}),(0,o.jsx)(l.N_,{to:"/books/details/".concat(t._id),className:"btn btn-sm btn-success",children:"Details"})]})})},h=e=>{let{books:a,currentUser:s,handleRequest:r,current:l}=e;return(0,o.jsx)(t.Suspense,{fallback:(0,o.jsx)(c.A,{}),children:(0,o.jsx)("section",{id:"browse_books",className:"mt-5",children:(0,o.jsx)("div",{className:"container",children:(0,o.jsx)("div",{className:"row",children:a.map(((e,a)=>(0,o.jsx)(m,{book:e,currentUser:s,handleRequest:r,current:l},a)))})})})})},b=e=>{let{pages:a,current:s,filter:t,value:r,handlePagination:l}=e;return(0,o.jsx)("nav",{className:"ml-3 mb-2",style:{marginTop:"20px"},children:(0,o.jsxs)("ul",{className:"pagination offset-md-3",children:[(0,o.jsx)("li",{className:"page-item ".concat(1===s?"disabled":""),children:(0,o.jsx)("a",{className:"page-link",href:"#",onClick:e=>{e.preventDefault(),l("/api/books/".concat(t,"/").concat(r,"/1"))},children:"First"})}),Array.from({length:Math.min(a,5)},((e,t)=>Math.max(1,Math.min(s-2,a-4))+t)).map((e=>(0,o.jsx)("li",{className:"page-item ".concat(e===s?"active":""),children:(0,o.jsx)("a",{className:"page-link",href:"#",onClick:a=>{a.preventDefault(),l("/api/books/".concat(t,"/").concat(r,"/").concat(e))},children:e})},e))),(0,o.jsx)("li",{className:"page-item ".concat(s<a?"":"disabled"),children:(0,o.jsx)("a",{className:"page-link",href:"#",onClick:e=>{e.preventDefault(),l("/api/books/".concat(t,"/").concat(r,"/").concat(a))},children:"Last"})})]})})},g=()=>{const[e,a]=(0,t.useState)([]),[s,l]=(0,t.useState)(0),[c,m]=(0,t.useState)(1),[g,p]=(0,t.useState)("all"),[x,j]=(0,t.useState)("all"),[v,N]=(0,t.useState)(null),[f,k]=(0,t.useState)(""),[y,w]=(0,t.useState)("");let S=1;(0,t.useEffect)((()=>{d=async()=>{try{const e=await r.A.get("/api/books/all/all/1"),{books:s,current:t,pages:n,filter:c,value:o,user:i}=e.data;a(s),m(t),l(n),p(c),j(o),N(i)}catch(f){k("Failed to fetch books. Please try again later.")}},d()}),[]);const C=(0,t.useCallback)((async e=>{try{const s=await r.A.get(e),{books:t,current:n,pages:c,filter:o,value:i}=s.data;a(t),m(n),l(c),p(o),j(i)}catch(f){console.error("Error handling pagination:",f),k("Failed to load page. Please try again.")}}),[]),_=(0,t.useCallback)((async(e,s,t)=>{e.preventDefault(),console.log(s,t);try{const e=await r.A.get("/api/books/".concat(s,"/").concat(t,"/1"),{headers:{"Content-Type":"application/x-www-form-urlencoded"}});if(console.log(e.data),e.data.error)return k(e.data.error);const{books:n,current:c,pages:o,filter:i,value:d}=e.data;a(n),m(c),l(o),p(i),j(d)}catch(f){console.error("Error submitting search:",f),k("Search failed. Please try again.")}}),[]),A=(0,t.useCallback)((async e=>{e.preventDefault();const s=new FormData(e.target),t=new URLSearchParams(s).toString();try{const s=await r.A.post(e.target.action,t,{headers:{"Content-Type":"application/x-www-form-urlencoded"}});if(s.data.error)return k(s.data.error);s.data.success&&w(s.data.success),s.data.current&&(S=s.data.current);const n=async()=>{try{const e=await r.A.get("/api/books/all/all/".concat(S)),{books:s,current:t,pages:n,filter:c,value:o,user:i}=e.data;a(s),m(t),l(n),p(c),j(o),N(i)}catch(f){k("Failed to fetch books. Please try again later.")}};n()}catch(f){console.error("Error requesting book:",f),k("Request failed. Please try again.")}}),[]),P=(0,t.useCallback)((async e=>{e.preventDefault();try{await r.A.get("/auth/user-logout"),window.location.reload()}catch(f){console.error("Error logging out:",f),k("Logout failed. Please try again.")}}),[]);return(0,o.jsxs)("div",{children:[(0,o.jsx)(u,{currentUser:v,logout:P}),(0,o.jsx)(i,{handleSubmit:_}),(0,o.jsx)(n.A,{error:f,success:y,dismissAlert:e=>{"error"===e?k(""):"success"===e&&w("")}}),(0,o.jsx)(h,{books:e,currentUser:v,handleRequest:A,current:c}),s>0&&(0,o.jsx)(b,{pages:s,current:c,filter:g,value:x,handlePagination:C})]})}},466:(e,a,s)=>{s.d(a,{A:()=>r});s(43);var t=s(579);const r=e=>{let{error:a,success:s,warning:r,dismissAlert:l}=e;return(0,t.jsxs)("div",{className:"container my-2 sticky-top",children:[a&&a.length>0&&(0,t.jsxs)("div",{className:"alert alert-danger alert-dismissible fade show",role:"alert",children:[a,(0,t.jsx)("button",{type:"button",className:"close","data-dismiss":"alert","aria-label":"Close",onClick:()=>l("error"),children:(0,t.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),s&&s.length>0&&(0,t.jsxs)("div",{className:"alert alert-success alert-dismissible fade show",role:"alert",children:[s,(0,t.jsx)("button",{type:"button",className:"close","data-dismiss":"alert","aria-label":"Close",onClick:()=>l("success"),children:(0,t.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),r&&r.length>0&&(0,t.jsxs)("div",{className:"alert alert-warning alert-dismissible fade show",role:"alert",children:[r,(0,t.jsx)("button",{type:"button",className:"close","data-dismiss":"alert","aria-label":"Close",onClick:()=>l("warning"),children:(0,t.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]})]})}}}]);
//# sourceMappingURL=105.8a400a8f.chunk.js.map